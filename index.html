<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Google Sheets Data</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css"
    />
  </head>
  <body>
    <section class="hero is-primary is-bold">
      <div class="hero-body">
        <div class="container">
          <h1 class="title">Google Sheets Data</h1>
        </div>
      </div>
    </section>
    <section class="section">
      <div class="container">
        <table class="table is-striped is-fullwidth" id="data-table">
          <thead>
            <tr id="table-headers"></tr>
          </thead>
          <tbody id="table-body"></tbody>
        </table>
      </div>
    </section>
    <script>
      // URL of your Google Apps Script doGet endpoint
      const scriptURL = "https://script.google.com/macros/s/AKfycbzoj-kkrERlWUjdyc7CMe7rtfCs6drrODLRgPp1N3a7F2m2efQLBKZKQSteqknc8X1kuw/exec";

      // Fetch data from Google Apps Script and populate the table
      async function fetchData() {
        try {
          const response = await fetch(scriptURL);
          const data = await response.json();

          // Clear existing data
          const tableHeaders = document.getElementById("table-headers");
          const tableBody = document.getElementById("table-body");
          tableHeaders.innerHTML = "";
          tableBody.innerHTML = "";

          if (data.length === 0) {
            tableBody.innerHTML = "<tr><td colspan='100%'>No data available</td></tr>";
            return;
          }

          // Add headers
          const headers = Object.keys(data[0]);
          headers.forEach(header => {
            const th = document.createElement("th");
            th.textContent = header;
            tableHeaders.appendChild(th);
          });

          // Add rows
          data.forEach(row => {
            const tr = document.createElement("tr");
            headers.forEach(header => {
              const td = document.createElement("td");
              td.textContent = row[header];
              tr.appendChild(td);
            });
            tableBody.appendChild(tr);
          });
        } catch (error) {
          console.error("Error fetching data:", error);
        }
      }

      // Fetch data on page load
      document.addEventListener("DOMContentLoaded", fetchData);
    </script>
  </body>
</html>
