<!DOCTYPE html>
<html>
  <head>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bulma@0.9.4/css/bulma.min.css"
    />
    <title>Sheet Data</title>
  </head>
  <body>
    <section class="hero is-info">
      <div class="hero-body">
        <div class="container">
          <h1 class="title">Sheet Data Table</h1>
        </div>
      </div>
    </section>
    <div class="container mt-5">
      <table class="table is-striped is-hoverable is-fullwidth" id="data-table">
        <thead id="table-head">
          <!-- Table headers will be dynamically populated -->
        </thead>
        <tbody id="table-body">
          <!-- Table rows will be dynamically populated -->
        </tbody>
      </table>
    </div>

    <script>
      // URL of your Apps Script Web App
      const scriptURL = "https://script.google.com/macros/s/AKfycby81iDLIk_9yHSDdUyFywbhfoB-ZOM1MmsR79Mh_eZ1_5d2U1lVNFTfIFmBLNodlItN/exec";

      // Fetch data from Apps Script Web App
      fetch(scriptURL)
        .then(response => response.json())
        .then(data => {
          const tableHead = document.getElementById("table-head");
          const tableBody = document.getElementById("table-body");

          // Populate table headers
          if (data.length > 0) {
            const headers = Object.keys(data[0]);
            const headerRow = document.createElement("tr");
            headers.forEach(header => {
              const th = document.createElement("th");
              th.textContent = header;
              headerRow.appendChild(th);
            });
            tableHead.appendChild(headerRow);
          }

          // Populate table rows
          data.forEach(row => {
            const rowElement = document.createElement("tr");
            for (const cell in row) {
              const cellElement = document.createElement("td");
              cellElement.textContent = row[cell];
              rowElement.appendChild(cellElement);
            }
            tableBody.appendChild(rowElement);
          });
        })
        .catch(error => {
          console.error("Error fetching data:", error);
        });
    </script>
  </body>
</html>
